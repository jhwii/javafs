<!doctype html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/layout1}">
<head>
    <meta charset="UTF-8">
    <title>결제하기</title>
    <script src="https://js.tosspayments.com/v1/payment"></script>
</head>
<style>
/* 결제 정보 컨테이너 */
.container {
    max-width: 400px;
    padding: 20px;
    background-color: #f8f8f8;
    border: 1px solid #ccc;
    border-radius: 5px;
}

/* 컨택트 제목 */
.contact-inner-title h2 {
    font-size: 24px;
    margin-bottom: 10px;
}

/* 주문 정보 */
.contact-inner-title span {
    font-size: 18px;
}

/* 주문번호, 차량명, 차량번호 */
.contact-inner-title span span {
    font-weight: bold;
}

/* 금액 */
#amount {
    font-size: 24px;
    color: #f58634;
    font-weight: bold;
    margin-top: 10px;
}

/* 구매하기 버튼 */
#payment_card_button {
    background-color: #f58634;
    color: #fff;
    font-size: 18px;
    border: none;
    border-radius: 5px;
    padding: 10px 10px;
    margin-top: 10px;
    cursor: pointer;
    transition: background-color 0.3s ease;
}

#payment_card_button:hover {
    background-color: #ff7539;
}
/* 주문 정보 간격 늘리기 */
.contact-inner-title span span {
   font-weight: bold;
    margin-bottom: 10px;
    margin-top: 10px;
}

</style>
<!-- Start Contact Area -->
<section id="contact-us" class="contact-us section">
    <input type="hidden" id="carId" th:value="${car.id}">
    <div class="container">
        <div class="contact-inner-title">
            <h2>결제 정보</h2>
            <span>
                <span>주문번호:</span>
                <span id="orderId">post-1</span>
            </span><br>
            <span>
                <span>차량명:</span>
               <span id="orderName" th:text="${car.carBrand + ' ' + car.carName}"></span>
            </span><br>
            <span>
                <span>차량번호:</span>
                <span id="customerName" th:text="${car.carNumber}"></span>
            </span>
        </div>

        <div class="contact-inner-title">
            <span>금액:</span>
            <span id="amount" th:text="${car.carPrice} + '원'"></span>
        </div>

        <div class="d-grid gap-2 m-t-20">
            <button id="payment_card_button" class="btn btn-warning size-h-65 payment-btn" type="submit">
                구매하기
            </button>
        </div>
    </div>
</section>

</body>

<script type="text/javascript" th:inline="javascript">
    var clientKey = 'test_ck_DLJOpm5QrlxP14voEWerPNdxbWnY';
    var tossPayments = TossPayments(clientKey);
    var button = document.getElementById('payment_card_button');
    let amount = parseInt(document.getElementById('amount').innerText);
    let orderId = document.getElementById('orderId').innerText;
    let orderName = document.getElementById('orderName').innerText;
    let customerName = document.getElementById('customerName').innerText;

    button.addEventListener('click', function () {
        tossPayments.requestPayment('카드', { // 결제 수단 파라미터
            amount: amount,
            orderId: orderId,
            orderName: orderName,
            customerName: customerName,
            successUrl: 'http://localhost:8080/security-login',
            failUrl: 'http://localhost:8080/fail',
        })
            .catch(function (error) {
                if (error.code === 'USER_CANCEL') {
                    // 결제 고객이 결제창을 닫았을 때 에러 처리
                } else if (error.code === 'INVALID_CARD_COMPANY') {
                    // 유효하지 않은 카드 코드에 대한 에러 처리
                }
            })
    });





</script>

</html>